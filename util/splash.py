# 通用
class TModernWarfareTunableConstante():
    def __init__(
        self,
        FrontSideAngleInDeg=None,
        TempsSansTirNiDamagePourPasserHorsCombat=None,
        TagStunned=None,
        TandemModifierType=None,
        LinkToCommonConstantes=None,
        SpreadDistanceUnitGRU=None,
        RearSideAngleInDeg=None,
        IgnoreTirPenetrantSiAucunBlindage=None,
        RefreshBestPlaceEveryNbSeconds=None,
        SplashCollisionPlanes=None,
        NbSalveDesignatedShot=None,
        MargePourLesTestsDeSortieDeDistrictLBU=None,
        MoteurHelicos_TempsDemarrage=None,
        TagUberstress=None,
        ArtilleryDispersionTargetNotVisible=None,
        DensitePointsRecherchePosition=None,
        MultiplicateurConsommationUnitesArretees=None,
        FuirDistrictEnFeu=None,
        MergeAllWeaponOnSameTurretInUI=None,
        TransformerAttackEnMoveSiPasDArmeAdaptee=None,
        AdditionalSuppressDamagePerLostPhysicalDamage=None,
        ShootingAdjustmentAngleMax=None,
        TempsSansStressPourRegen=None,
        TagNonRadarTargetable=None,
        RegenStressParSeconde=None,
        FacteurMinTempsViseeReel=None,
        MoteurHelicos_TempsArret=None,
        DurationForLeavingDistrict=None,
        TandemModifierValue=None,
        DistanceToAddToEnnemiDetectionForOtherWeaponGRU=None,
        ClustersDimensionMaxGRU=None,
        PorteeMinArmeEstConsidereCommeArtillerieGRU=None,
        SplashSurTirRate=None,
        SplashRatioDistance=None,
        DistanceMinFleeFireGRU=None,
        DistanceRelaunchMouvementForMoveAndAttackGRU=None,
        DistanceInfanterieEnnemiDetectionGRU=None,
        DistanceToAddToEnnemiDetectionForAAWeaponGRU=None,
        TagAllowedForMissileRoE=None,
        RelativeBonusMoneyByIADifficulty=None,
        DistanceFriendlyFireGRU=None,
        RatioSupplyAmmoAndFuel=None,
        DistanceToAddToEnnemiDetectionForAntiProjectileWeaponGRU=None,
        SpreadDistanceGroupGRU=None,
        DureeDeRevelationApresAttaque=None,
        SplashRatioDamage=None,
    ):
        self.FrontSideAngleInDeg = FrontSideAngleInDeg
        self.TempsSansTirNiDamagePourPasserHorsCombat = (
            TempsSansTirNiDamagePourPasserHorsCombat
        )
        self.TagStunned = TagStunned
        self.TandemModifierType = TandemModifierType
        self.LinkToCommonConstantes = LinkToCommonConstantes
        self.SpreadDistanceUnitGRU = SpreadDistanceUnitGRU
        self.RearSideAngleInDeg = RearSideAngleInDeg
        self.IgnoreTirPenetrantSiAucunBlindage = IgnoreTirPenetrantSiAucunBlindage
        self.RefreshBestPlaceEveryNbSeconds = RefreshBestPlaceEveryNbSeconds
        self.SplashCollisionPlanes = SplashCollisionPlanes
        self.NbSalveDesignatedShot = NbSalveDesignatedShot
        self.MargePourLesTestsDeSortieDeDistrictLBU = (
            MargePourLesTestsDeSortieDeDistrictLBU
        )
        self.MoteurHelicos_TempsDemarrage = MoteurHelicos_TempsDemarrage
        self.TagUberstress = TagUberstress
        self.ArtilleryDispersionTargetNotVisible = ArtilleryDispersionTargetNotVisible
        self.DensitePointsRecherchePosition = DensitePointsRecherchePosition
        self.MultiplicateurConsommationUnitesArretees = (
            MultiplicateurConsommationUnitesArretees
        )
        self.FuirDistrictEnFeu = FuirDistrictEnFeu
        self.MergeAllWeaponOnSameTurretInUI = MergeAllWeaponOnSameTurretInUI
        self.TransformerAttackEnMoveSiPasDArmeAdaptee = (
            TransformerAttackEnMoveSiPasDArmeAdaptee
        )
        self.AdditionalSuppressDamagePerLostPhysicalDamage = (
            AdditionalSuppressDamagePerLostPhysicalDamage
        )
        self.ShootingAdjustmentAngleMax = ShootingAdjustmentAngleMax
        self.TempsSansStressPourRegen = TempsSansStressPourRegen
        self.TagNonRadarTargetable = TagNonRadarTargetable
        self.RegenStressParSeconde = RegenStressParSeconde
        self.FacteurMinTempsViseeReel = FacteurMinTempsViseeReel
        self.MoteurHelicos_TempsArret = MoteurHelicos_TempsArret
        self.DurationForLeavingDistrict = DurationForLeavingDistrict
        self.TandemModifierValue = TandemModifierValue
        self.DistanceToAddToEnnemiDetectionForOtherWeaponGRU = (
            DistanceToAddToEnnemiDetectionForOtherWeaponGRU
        )
        self.ClustersDimensionMaxGRU = ClustersDimensionMaxGRU
        self.PorteeMinArmeEstConsidereCommeArtillerieGRU = (
            PorteeMinArmeEstConsidereCommeArtillerieGRU
        )
        self.SplashSurTirRate = SplashSurTirRate
        self.SplashRatioDistance = SplashRatioDistance
        self.DistanceMinFleeFireGRU = DistanceMinFleeFireGRU
        self.DistanceRelaunchMouvementForMoveAndAttackGRU = (
            DistanceRelaunchMouvementForMoveAndAttackGRU
        )
        self.DistanceInfanterieEnnemiDetectionGRU = DistanceInfanterieEnnemiDetectionGRU
        self.DistanceToAddToEnnemiDetectionForAAWeaponGRU = (
            DistanceToAddToEnnemiDetectionForAAWeaponGRU
        )
        self.TagAllowedForMissileRoE = TagAllowedForMissileRoE
        self.RelativeBonusMoneyByIADifficulty = RelativeBonusMoneyByIADifficulty
        self.DistanceFriendlyFireGRU = DistanceFriendlyFireGRU
        self.RatioSupplyAmmoAndFuel = RatioSupplyAmmoAndFuel
        self.DistanceToAddToEnnemiDetectionForAntiProjectileWeaponGRU = (
            DistanceToAddToEnnemiDetectionForAntiProjectileWeaponGRU
        )
        self.SpreadDistanceGroupGRU = SpreadDistanceGroupGRU
        self.DureeDeRevelationApresAttaque = DureeDeRevelationApresAttaque
        self.SplashRatioDamage = SplashRatioDamage

    def __repr__(self):
        return (
            f"<TModernWarfareTunableConstante "
            + ", ".join(
                [
                    f"{attr}={getattr(self, attr)}"
                    for attr in [
                        "FrontSideAngleInDeg",
                        "TempsSansTirNiDamagePourPasserHorsCombat",
                        "TagStunned",
                        "TandemModifierType",
                        "LinkToCommonConstantes",
                        "SpreadDistanceUnitGRU",
                        "RearSideAngleInDeg",
                        "IgnoreTirPenetrantSiAucunBlindage",
                        "RefreshBestPlaceEveryNbSeconds",
                        "SplashCollisionPlanes",
                        "NbSalveDesignatedShot",
                        "MargePourLesTestsDeSortieDeDistrictLBU",
                        "MoteurHelicos_TempsDemarrage",
                        "TagUberstress",
                        "ArtilleryDispersionTargetNotVisible",
                        "DensitePointsRecherchePosition",
                        "MultiplicateurConsommationUnitesArretees",
                        "FuirDistrictEnFeu",
                        "MergeAllWeaponOnSameTurretInUI",
                        "TransformerAttackEnMoveSiPasDArmeAdaptee",
                        "AdditionalSuppressDamagePerLostPhysicalDamage",
                        "ShootingAdjustmentAngleMax",
                        "TempsSansStressPourRegen",
                        "TagNonRadarTargetable",
                        "RegenStressParSeconde",
                        "FacteurMinTempsViseeReel",
                        "MoteurHelicos_TempsArret",
                        "DurationForLeavingDistrict",
                        "TandemModifierValue",
                        "DistanceToAddToEnnemiDetectionForOtherWeaponGRU",
                        "ClustersDimensionMaxGRU",
                        "PorteeMinArmeEstConsidereCommeArtillerieGRU",
                        "SplashSurTirRate",
                        "SplashRatioDistance",
                        "DistanceMinFleeFireGRU",
                        "DistanceRelaunchMouvementForMoveAndAttackGRU",
                        "DistanceInfanterieEnnemiDetectionGRU",
                        "DistanceToAddToEnnemiDetectionForAAWeaponGRU",
                        "TagAllowedForMissileRoE",
                        "RelativeBonusMoneyByIADifficulty",
                        "DistanceFriendlyFireGRU",
                        "RatioSupplyAmmoAndFuel",
                        "DistanceToAddToEnnemiDetectionForAntiProjectileWeaponGRU",
                        "SpreadDistanceGroupGRU",
                        "DureeDeRevelationApresAttaque",
                        "SplashRatioDamage",
                    ]
                ]
            )
            + ">"
        )

    def splash_damage_percent_by_radius_ratio(self, radius_ratio):
        if self.SplashSurTirRate == False:
            return 0
        
        current_damage = 1.0
        current_distance = 0
        next_distance = 0
        reduction_amount = 0
        

        for dmg_reduction, dist_threshold in zip(self.SplashRatioDamage, self.SplashRatioDistance):
            current_distance = next_distance
            next_distance = current_distance + dist_threshold

            if  current_distance <= radius_ratio <= next_distance:
                return current_damage - reduction_amount * (radius_ratio - current_distance)/(next_distance - current_distance) 
            else:
                current_damage -= reduction_amount 
                reduction_amount = dmg_reduction
                
        return 0
    

def test_splash_damage_percent_by_radius_ratio():
    SplashRatioDamage = [0.35, 0.35, 0.25]
    SplashRatioDistance = [0.35, 0.35, 0.30] 
    MWTC = TModernWarfareTunableConstante(SplashRatioDamage=SplashRatioDamage, SplashRatioDistance=SplashRatioDistance)
    test1 = MWTC.splash_damage_percent_by_radius_ratio(0.35)
    print(test1)
    test2 = MWTC.splash_damage_percent_by_radius_ratio(0.7)
    print(test2)
    test3 = MWTC.splash_damage_percent_by_radius_ratio(1)
    print(test3)
    test3 = MWTC.splash_damage_percent_by_radius_ratio(1.01)
    print(test3)

test_splash_damage_percent_by_radius_ratio()